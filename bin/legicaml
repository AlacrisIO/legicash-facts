#!/bin/bash -eu

here=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )
export LEGICASH_HOME=$(dirname "$here")
build=$LEGICASH_HOME/_build/default
legicaml=$build/src/legicaml.exe

if [ ! -x $legicaml ] ; then
    echo "Please run \"make toplevel\" before running $0";
    exit 0
fi

LIB=

use_lib () {
    for lib ; do
        LIB=(${LIB[@]} -I "$build/src/$lib/.$lib.objs" -open "${lib^}")
    done
}

# Starting Legicash OCaml toplevel...
use_lib legilogic_lib legilogic_ethereum legicash_lib
$legicaml "${LIB[@]}" "$@"
